<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Jay Lux Ferro ">
<meta name="description" content="Abstract GhanaPostGPS is Ghana&amp;rsquo;s official digital addressing system which ensures that all locations in the country are addressed. Each location has a unique address which is a composite of the postcode (region, district &amp;amp; area code). Its core functionality is to translate a user&amp;rsquo;s GPS location coordinates to a user-friendly digital address. Those who developed the addressing system did not make available a public application programming interface (API) that can be used by local developers in building technological solutions." />
<meta name="keywords" content="research, cybersecurity, Android, iOS, Security, Audit" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/post/ghanapostgps/" />


    <title>
        
            Reverse Engineering GhanaPostGPS Mobile Application to Create an API for Local Developers :: SPERIXLABS 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.d7bdd8ee18bfbf4c605488a7e5b1b92cd980dfeed2bdaeab4dd5e931a7a78bc0.css">




    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="Reverse Engineering GhanaPostGPS Mobile Application to Create an API for Local Developers">
<meta itemprop="description" content="Abstract GhanaPostGPS is Ghana&rsquo;s official digital addressing system which ensures that all locations in the country are addressed. Each location has a unique address which is a composite of the postcode (region, district &amp; area code). Its core functionality is to translate a user&rsquo;s GPS location coordinates to a user-friendly digital address. Those who developed the addressing system did not make available a public application programming interface (API) that can be used by local developers in building technological solutions.">
<meta itemprop="datePublished" content="2020-09-05T17:07:23+00:00" />
<meta itemprop="dateModified" content="2020-09-05T17:07:23+00:00" />
<meta itemprop="wordCount" content="924">
<meta itemprop="image" content="/"/>



<meta itemprop="keywords" content="Android,iOS,Security,Audit," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Reverse Engineering GhanaPostGPS Mobile Application to Create an API for Local Developers"/>
<meta name="twitter:description" content="Abstract GhanaPostGPS is Ghana&rsquo;s official digital addressing system which ensures that all locations in the country are addressed. Each location has a unique address which is a composite of the postcode (region, district &amp; area code). Its core functionality is to translate a user&rsquo;s GPS location coordinates to a user-friendly digital address. Those who developed the addressing system did not make available a public application programming interface (API) that can be used by local developers in building technological solutions."/>




    <meta property="og:title" content="Reverse Engineering GhanaPostGPS Mobile Application to Create an API for Local Developers" />
<meta property="og:description" content="Abstract GhanaPostGPS is Ghana&rsquo;s official digital addressing system which ensures that all locations in the country are addressed. Each location has a unique address which is a composite of the postcode (region, district &amp; area code). Its core functionality is to translate a user&rsquo;s GPS location coordinates to a user-friendly digital address. Those who developed the addressing system did not make available a public application programming interface (API) that can be used by local developers in building technological solutions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/ghanapostgps/" />
<meta property="og:image" content="/"/>
<meta property="article:published_time" content="2020-09-05T17:07:23+00:00" />
<meta property="article:modified_time" content="2020-09-05T17:07:23+00:00" />




    <meta property="article:section" content="Reverse Engineering" />



    <meta property="article:published_time" content="2020-09-05 17:07:23 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd ~/home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/post/">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/post/ghanapostgps/">Reverse Engineering GhanaPostGPS Mobile Application to Create an API for Local Developers</a></h2>

            
            
            

            <div class="post-content">
                <h3 id="abstract">Abstract</h3>
<p>GhanaPostGPS is Ghana&rsquo;s official digital addressing system which ensures that all locations in the country are addressed. Each location has a unique address which is a composite of the postcode (region, district &amp; area code). Its core functionality is to translate a user&rsquo;s GPS location coordinates to a user-friendly digital address. Those who developed the addressing system did not make available a public application programming interface (API) that can be used by local developers in building technological solutions. This research presents how the digital addressing system&rsquo;s mobile application was reversed engineered to create a publicly available API (<strong><a href="https://jayluxferro.github.io/post/ghpgps/">https://jayluxferro.github.io/post/ghpgps/</a></strong>).</p>
<h3 id="introduction">Introduction</h3>
<p>Digital addressing is a modern and revolutionary approach to allocating addresses within a defined space with the aid of the latest geocoding technology. Ghana, in its effort of enhancing digitization, has introduced this digital addressing system (GhanaPostGPS) which covers every inch of the country and ensures that all locations in the country are addressed [1]. With GhanaPostGPS, every location has a unique digital address. It is rather unfortunate that digital solutions built in the country do not make use of this addressing system since there isn&rsquo;t a publicly available API; hence the essence of this research.</p>
<h3 id="how-does-the-ghanapostgps-application-work">How does the GhanaPostGPS Application work?</h3>
<p>The communication process follows a client-server architecture (as shown in the figure below). The application runs on both mobile (iOS and Android) and web platforms.</p>
<!-- raw HTML omitted -->
<p>When a user launches the application, he has the option to sign in (if he&rsquo;s an existing using), sign up as a new user or use the app without registering (anonymous account). Phone numbers are used in signing on to the platform and verified through a short message service (SMS). When a user signs in successfully, he has the ability to register/generate a digital address and also query for location details (either by name or by address). The mobile applications (iOS and Android) have panic buttons which help users in easy communication with the Police, Fire and Ambulance services in the event of an imminent danger. This is made possible due to the integration of a session initiation protocol (SIP)[2] API in the mobile clients.</p>
<h3 id="end-to-end--encryption-e2ee">End-to-End  Encryption (E2EE)</h3>
<p>Communication between the clients and the web service uses asymmetric encryption. When the application is launched for the first time, the mobile client connects to the endpoint <strong><a href="https://api.ghanapostgps.com/GetAPIData.aspx">https://api.ghanapostgps.com/GetAPIData.aspx</a></strong> to get the server&rsquo;s public key (a sample is shown below).</p>
<pre><code>	-----BEGIN PUBLIC KEY-----
	MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlO6O2gAGlT4+YP+evP9c
	9qynWdv/qIAx5Jc4kp+UTmrsn8wJn4bD9H8rynSvepH0navZiDwYvioAPbIcR6cG
	MMFnP5/2wN9zrBFZtnofcpSrk4q9/GRHj4IuHheQjvMiislrRdIEgqxjMQ1aaiG7
	+MeoeQuHz08O+aecHuMtJTXzcIQDqkMHkeA/yt/ge/ASDqSRn0Hdpa/4OA/ZtVpT
	8Ph2lLgMv+O5Iz11UIwSqyewSdAZzX0H4jUPKCCfnhgWsS+7WJU6KufYptvl0/P4
	NSdJKSdYg/y44pWiPxlgMUf6s1nOXJJ0vSi0zrDFjx+y+GD2h+dMBRWe9nym+NmJ
	1QIDAQAB
	-----END PUBLIC KEY-----
</code></pre><p>Upon getting the public key, the mobile client generates a random string (using the method below) of length 16 characters.</p>
<pre><code>	 private static final String ALLOWED_CHARACTERS = &quot;0123456789qwertyuiopasdfghjklzxcvbnm!@$#^&amp;*()&quot;;
	 public static String getRandomString(int i) {
	 	Random random = new Random();
	 	StringBuilder sb = new StringBuilder(i);
	 	for (int i2 = 0; i2 &lt; i; i2++) {
	 		sb.append(ALLOWED_CHARACTERS.charAt(random.nextInt(ALLOWED_CHARACTERS.length())));
	 	}
	 	return sb.toString();
	 }
</code></pre><p>The generated random string becomes a symmetric key that is used in the encryption and decryption of data between the client and the server. The client sends the generated random string (16 bytes) together with a universally unique identifier (UUID) and the operating system&rsquo;s name (Android or iOS) to the server. This data is encrypted (using RSA) and encoded in base64 using the server&rsquo;s public key before it is sent. A sample is shown below:</p>
<pre><code>	TiJ/O4d2rFzaR046lLMYBJ6yU3e+vqDjkrYNVrhFm9K+jLXbMzTB6xAdtz/f/Rx+Nyw5ZB64ok3v8MRJq9jf8NwpYeFQZUGR0UzMmg
	EgYR3MlAgFz7vRkQt0GGt/BwEaK081PJKxnqVqqXjr3NqNbfJr3GDDkfIfVKT4xOZRZbcCFdPpDD6Ofb5RD7mL8LQLvwOPOUVq3+/
	MlNDVhxOD4Osq0PqWh8CvrZY8y2Q1sDJYDTUsKFn0ChxFNtJhso1ImtqLBkNFZbrWUXn6NbHV+p3HBJVeZNcJxlWPPHaBh8Ip7
	qPOnnMww4ZXWC88/tWTlScFemwTcyGpT58T9rMySA==
</code></pre><p>The server responds by sending a base64 encoded data which can be decrypted using the client&rsquo;s symmetric key. The decrypted data is shown below.</p>
<pre><code>	PlsUseYourOwnKey||https://api.ghanapostgps.com/PublicGPGPSAPI.aspx
</code></pre><p>The decrypted data contained a new endpoint <strong><a href="https://api.ghanapostgps.com/PublicGPGPSAPI.aspx">https://api.ghanapostgps.com/PublicGPGPSAPI.aspx</a></strong> through which all subsequent communications were made. The symmetric encryption used is advanced encryption standard (AES); as shown below.</p>
<pre><code>	// Java, AES CBC Encryption
	package com.ghanapostgps.ghanapost.util;

	import android.util.Base64;
	import javax.crypto.Cipher;
	import javax.crypto.spec.IvParameterSpec;
	import javax.crypto.spec.SecretKeySpec;
	import org.apache.commons.compress.utils.CharsetNames;

	public class AESenc {
		private String key = &quot;&quot;;

		public AESenc(String str) {
			this.key = str;
		}

		public String encrypt(String str) {
			try {
				byte[] bytes = Utils.getRandomString(16).getBytes(CharsetNames.UTF_8);
				IvParameterSpec ivParameterSpec = new IvParameterSpec(bytes);
				SecretKeySpec secretKeySpec = new SecretKeySpec(this.key.getBytes(CharsetNames.UTF_8), &quot;AES&quot;);
				Cipher instance = Cipher.getInstance(&quot;AES/CBC/PKCS7PADDING&quot;);
				instance.init(1, secretKeySpec, ivParameterSpec);
				byte[] doFinal = instance.doFinal(str.getBytes());
				byte[] bArr = new byte[(bytes.length + doFinal.length)];
				System.arraycopy(bytes, 0, bArr, 0, bytes.length);
				System.arraycopy(doFinal, 0, bArr, 16, doFinal.length);
				return Base64.encodeToString(bArr, 0);
			} catch (Exception e) {
				e.printStackTrace();
				return null;
			}
		}

		public String decrypt(String str) {
			try {
				byte[] decode = Base64.decode(str, 0);
				int length = decode.length - 16;
				byte[] bArr = new byte[length];
				byte[] bArr2 = new byte[16];
				System.arraycopy(decode, 0, bArr2, 0, 16);
				System.arraycopy(decode, 16, bArr, 0, length);
				IvParameterSpec ivParameterSpec = new IvParameterSpec(bArr2);
				SecretKeySpec secretKeySpec = new SecretKeySpec(this.key.getBytes(CharsetNames.UTF_8), &quot;AES&quot;);
				Cipher instance = Cipher.getInstance(&quot;AES/CBC/PKCS5PADDING&quot;);
				instance.init(2, secretKeySpec, ivParameterSpec);
				return new String(instance.doFinal(bArr));
			} catch (Exception e) {
				e.printStackTrace();
				return null;
			}
		}
	}
</code></pre><p>From the AES encryption/decryption method, the initializing vector (IV) is the first 16 bytes of the base64 decoded data. When the client is encrypting a piece of data to be sent to the server, it generates a 16 byte string based on the <strong>getRandomString</strong> method; this forms the first 16 bytes of the data to be sent. The actual data is encrypted using the symmetric key and the randomly generated 16 bytes string (the IV). Afterwards, the data is base64 encoded before it is sent.</p>
<p>The client decrypts the information received from the server by decoding the base64 string. It then extracts the first 16 bytes as the IV. The remaining bytes of data is decrypted using the symmetric key and the IV.</p>
<p>The same E2EE mechanism was implemented in Golang which was used in developing the public API. Details of the implementation can be found using <strong><a href="https://github.com/jayluxferro/ghanapostgps">https://github.com/jayluxferro/ghanapostgps</a></strong>.</p>
<h3 id="references">References</h3>
<ol>
<li>GhanaPostGPS, <a href="https://ghanapostgps.com">https://ghanapostgps.com</a>.</li>
<li>Session Initiation Protocol (SIP), <a href="https://tools.ietf.org/html/rfc3261">https://tools.ietf.org/html/rfc3261</a>.</li>
<li>Universally Unique IDentifier (UUID), <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a>.</li>
</ol>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="/tags/android/">Android</a></span>
        <span class="tag"><a href="/tags/ios/">iOS</a></span>
        <span class="tag"><a href="/tags/security/">Security</a></span>
        <span class="tag"><a href="/tags/audit/">Audit</a></span>
        
    </p>

            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="/categories/reverse-engineering/">Reverse Engineering</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            <span><a href="/">Jay Lux Ferro</a></span>
            <span>SPERIXLABS</span><span><a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Your Security</span>
            <span>Go Player</span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.af435e44374f1e99a669ea8cd5bb9a2fceed80588941a451bfddb66b86a67c9f40b0f417e9543a763f809aa7e9300d7b1d69bf99615810ba02ac70396d50fad5.js" integrity="sha512-r0NeRDdPHpmmaeqM1buaL87tgFiJQaRRv922a4amfJ9AsPQX6VQ6dj&#43;AmqfpMA17HWm/mWFYELoCrHA5bVD61Q=="></script>



    </body>
</html>
